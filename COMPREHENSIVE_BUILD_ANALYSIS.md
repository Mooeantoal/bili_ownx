# ç»¼åˆæ„å»ºé—®é¢˜åˆ†ææŠ¥å‘Š

## ğŸ” å‘ç°çš„ä¸»è¦é—®é¢˜

### 1. **Android SDK è·¯å¾„å†²çªé—®é¢˜** âš ï¸ é«˜ä¼˜å…ˆçº§
**é—®é¢˜æè¿°**: Flutteræ„å»ºè¿‡ç¨‹ä¸­Android SDK Platform 35è¢«å®‰è£…åˆ°äº†é”™è¯¯çš„ç›®å½•
```
Warning: Package "Android SDK Platform 35" should be installed in 
"/home/runner/work/bili_ownx/bili_ownx/android-sdk/platforms/android-35" but 
it already exists.
Installing in "/home/runner/work/bili_ownx/bili_ownx/android-sdk/platforms/android-35-2" instead.
```

**æ ¹æœ¬åŸå› **: 
- CIè„šæœ¬ä¸­é¢„å…ˆå®‰è£…äº†android-35å¹³å°
- Flutteræ„å»ºæ—¶å°è¯•é‡æ–°å®‰è£…ï¼Œç”±äºç›®å½•å·²å­˜åœ¨ï¼Œå®‰è£…åˆ°android-35-2
- æ„å»ºç³»ç»Ÿå¯»æ‰¾android-35ï¼Œä½†å®é™…å®‰è£…åœ¨android-35-2

**ä¿®å¤æ–¹æ¡ˆ**: âœ… å·²åœ¨æœ€æ–°CIé…ç½®ä¸­ä¿®å¤
- æ·»åŠ äº†SDKéªŒè¯æ­¥éª¤
- ç”Ÿæˆæ­£ç¡®çš„local.propertiesæ–‡ä»¶
- æ¸…ç†é‡å¤å®‰è£…é—®é¢˜

### 2. **ä¾èµ–å†²çªå†å²é—®é¢˜** âš ï¸ ä¸­ç­‰ä¼˜å…ˆçº§
**é—®é¢˜æè¿°**: ä¹‹å‰å­˜åœ¨flutter_pipåŒ…ç‰ˆæœ¬å†²çª
```
Because bili_ownx depends on flutter_pip ^0.1.1 which doesn't match any versions, version solving failed.
```

**å½“å‰çŠ¶æ€**: âœ… å·²ä¿®å¤
- flutter_pipå·²è¢«ç§»é™¤ï¼ˆæ³¨é‡Šæ‰ï¼‰
- æ”¹ç”¨åŸç”Ÿå¹³å°å®ç°ç”»ä¸­ç”»åŠŸèƒ½

### 3. **æ„å»ºé…ç½®ä¼˜åŒ–é—®é¢˜** â„¹ï¸ ä½ä¼˜å…ˆçº§
**Gradleé…ç½®**:
- JVMå†…å­˜è®¾ç½®åˆç† (8G heap, 4G metaspace)
- å¯ç”¨äº†å¹¶è¡Œæ„å»ºå’Œç¼“å­˜
- ä½¿ç”¨AndroidXå’ŒJetifier

**æ½œåœ¨ä¼˜åŒ–ç‚¹**:
- å¯ä»¥è€ƒè™‘å¢åŠ æ›´è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
- ä¾èµ–ç‰ˆæœ¬å¯ä»¥å®šæœŸæ›´æ–°

### 4. **æƒé™é…ç½®æ£€æŸ¥** âœ… æ­£å¸¸
**Androidæƒé™**:
- ç½‘ç»œæƒé™: âœ… INTERNET, ACCESS_NETWORK_STATE
- å­˜å‚¨æƒé™: âœ… READ/WRITE_EXTERNAL_STORAGE  
- åª’ä½“æƒé™: âœ… READ_MEDIA_VIDEO (Android 13+)
- é€šçŸ¥æƒé™: âœ… POST_NOTIFICATIONS (Android 14+)
- ç”»ä¸­ç”»: âœ… SYSTEM_ALERT_WINDOW, supportsPictureInPicture=true

## ğŸ”§ å½“å‰ä¿®å¤çŠ¶æ€

### å·²ä¿®å¤çš„é—®é¢˜:
1. âœ… Android SDKè·¯å¾„é…ç½® - é€šè¿‡éªŒè¯æ­¥éª¤å’ŒåŠ¨æ€local.propertiesç”Ÿæˆ
2. âœ… è®¸å¯è¯æ¥å—è‡ªåŠ¨åŒ– - é€šè¿‡expectè„šæœ¬
3. âœ… ä¾èµ–å†²çª - flutter_pipå·²ç§»é™¤
4. âœ… CI/CDç¯å¢ƒå˜é‡é…ç½®

### éœ€è¦ç›‘æ§çš„é—®é¢˜:
1. ğŸ”„ SDKç‰ˆæœ¬å…¼å®¹æ€§ - å®šæœŸæ£€æŸ¥Android SDKæ›´æ–°
2. ï¿½Flutterç‰ˆæœ¬å…¼å®¹æ€§ - å½“å‰3.24.0ï¼Œéœ€è¦å…³æ³¨æ–°ç‰ˆæœ¬
3. ğŸ”„ ä¾èµ–åŒ…æ›´æ–° - å®šæœŸè¿è¡Œ`flutter pub outdated`

## ğŸš€ æ„å»ºä¼˜åŒ–å»ºè®®

### 1. **æ„å»ºç¼“å­˜ä¼˜åŒ–**
```yaml
- name: æ¸…ç†æ„å»ºç¼“å­˜
  run: |
    flutter clean
    rm -rf .gradle/caches/
```

### 2. **ä¾èµ–é¢„æ£€æŸ¥**
```yaml
- name: ä¾èµ–å…¼å®¹æ€§æ£€æŸ¥  
  run: |
    flutter pub deps
    flutter pub outdated
```

### 3. **æ„å»ºéªŒè¯**
```yaml
- name: æ„å»ºåéªŒè¯
  run: |
    ls -la build/app/outputs/flutter-apk/
    file build/app/outputs/flutter-apk/app-debug.apk
```

## ğŸ“Š é£é™©è¯„ä¼°

| é—®é¢˜ç±»åˆ« | é£é™©çº§åˆ« | çŠ¶æ€ | å½±å“ |
|---------|---------|------|------|
| SDKè·¯å¾„å†²çª | é«˜ | âœ… å·²ä¿®å¤ | æ„å»ºå¤±è´¥ |
| ä¾èµ–å†²çª | ä¸­ | âœ… å·²ä¿®å¤ | ç‰ˆæœ¬è§£æå¤±è´¥ |
| æƒé™é…ç½® | ä½ | âœ… æ­£å¸¸ | åŠŸèƒ½é™åˆ¶ |
| æ€§èƒ½ä¼˜åŒ– | ä½ | â„¹ï¸ å¯ä¼˜åŒ– | æ„å»ºæ—¶é—´ |

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**: 
   - éªŒè¯æœ€æ–°CIé…ç½®æ˜¯å¦è§£å†³SDKè·¯å¾„é—®é¢˜
   - ç›‘æ§ä¸‹æ¬¡æ„å»ºç»“æœ

2. **çŸ­æœŸä¼˜åŒ–**:
   - æ·»åŠ æ„å»ºåéªŒè¯æ­¥éª¤
   - å®šæœŸæ›´æ–°ä¾èµ–åŒ…ç‰ˆæœ¬

3. **é•¿æœŸç»´æŠ¤**:
   - å»ºç«‹ä¾èµ–æ›´æ–°è‡ªåŠ¨åŒ–æ£€æŸ¥
   - ç›‘æ§Flutterå’ŒAndroid SDKç‰ˆæœ¬æ›´æ–°

---
*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-12-11*
*åˆ†æè¦†ç›–èŒƒå›´: CI/CDé…ç½®ã€ä¾èµ–ç®¡ç†ã€æ„å»ºè¿‡ç¨‹ã€æƒé™é…ç½®*